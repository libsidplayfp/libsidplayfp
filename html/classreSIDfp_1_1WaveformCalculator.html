<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libsidplayfp: reSIDfp::WaveformCalculator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libsidplayfp
   &#160;<span id="projectnumber">2.7.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>reSIDfp</b></li><li class="navelem"><a class="el" href="classreSIDfp_1_1WaveformCalculator.html">WaveformCalculator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classreSIDfp_1_1WaveformCalculator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">reSIDfp::WaveformCalculator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="WaveformCalculator_8h_source.html">WaveformCalculator.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6cc8f7337506dad1ea099d7e802d9d69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmatrix.html">matrix_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreSIDfp_1_1WaveformCalculator.html#a6cc8f7337506dad1ea099d7e802d9d69">getWaveTable</a> ()</td></tr>
<tr class="separator:a6cc8f7337506dad1ea099d7e802d9d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e89f0c4e00a2f75dc90080b17ed2ef2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmatrix.html">matrix_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreSIDfp_1_1WaveformCalculator.html#a6e89f0c4e00a2f75dc90080b17ed2ef2">buildPulldownTable</a> (ChipModel model, CombinedWaveforms cws)</td></tr>
<tr class="separator:a6e89f0c4e00a2f75dc90080b17ed2ef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a70ffec367dd863bd6f03e61ecc4ba2c0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classreSIDfp_1_1WaveformCalculator.html">WaveformCalculator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreSIDfp_1_1WaveformCalculator.html#a70ffec367dd863bd6f03e61ecc4ba2c0">getInstance</a> ()</td></tr>
<tr class="separator:a70ffec367dd863bd6f03e61ecc4ba2c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Combined waveform calculator for <a class="el" href="classreSIDfp_1_1WaveformGenerator.html">WaveformGenerator</a>. By combining waveforms, the bits of each waveform are effectively short circuited, a zero bit in one waveform will result in a zero output bit, thus the claim that the waveforms are AND'ed. However, a zero bit in one waveform may also affect the neighboring bits in the output.</p>
<p>Example: </p><pre class="fragment">            1 1
Bit #       1 0 9 8 7 6 5 4 3 2 1 0
            -----------------------
Sawtooth    0 0 0 1 1 1 1 1 1 0 0 0

Triangle    0 0 1 1 1 1 1 1 0 0 0 0

AND         0 0 0 1 1 1 1 1 0 0 0 0

Output      0 0 0 0 1 1 1 0 0 0 0 0
</pre><p>Re-vectorized die photographs reveal the mechanism behind this behavior. Each waveform selector bit acts as a switch, which directly connects internal outputs into the waveform DAC inputs as follows:</p>
<ul>
<li>Noise outputs the shift register bits to DAC inputs as described above. Each output is also used as input to the next bit when the shift register is shifted. Lower four bits are grounded.</li>
<li>Pulse connects a single line to all DAC inputs. The line is connected to either 5V (pulse on) or 0V (pulse off) at bit 11, and ends at bit 0.</li>
<li>Triangle connects the upper 11 bits of the (MSB EOR'ed) accumulator to the DAC inputs, so that DAC bit 0 = 0, DAC bit n = accumulator bit n - 1.</li>
<li>Sawtooth connects the upper 12 bits of the accumulator to the DAC inputs, so that DAC bit n = accumulator bit n. Sawtooth blocks out the MSB from the EOR used to generate the triangle waveform.</li>
</ul>
<p>We can thus draw the following conclusions:</p>
<ul>
<li>The shift register may be written to by combined waveforms.</li>
<li>The pulse waveform interconnects all bits in combined waveforms via the pulse line.</li>
<li>The combination of triangle and sawtooth interconnects neighboring bits of the sawtooth waveform.</li>
</ul>
<p>Also in the 6581 the MSB of the oscillator, used as input for the triangle xor logic and the pulse adder's last bit, is connected directly to the waveform selector, while in the 8580 it is latched at sid_clk2 before being forwarded to the selector. Thus in the 6581 if the sawtooth MSB is pulled down it might affect the oscillator's adder driving the top bit low. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a6e89f0c4e00a2f75dc90080b17ed2ef2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e89f0c4e00a2f75dc90080b17ed2ef2">&#9670;&nbsp;</a></span>buildPulldownTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmatrix.html">matrix_t</a> * reSIDfp::WaveformCalculator::buildPulldownTable </td>
          <td>(</td>
          <td class="paramtype">ChipModel&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CombinedWaveforms&#160;</td>
          <td class="paramname"><em>cws</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Build pulldown table for use by <a class="el" href="classreSIDfp_1_1WaveformGenerator.html">WaveformGenerator</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td>Chip model to use </td></tr>
    <tr><td class="paramname">cws</td><td>strength of combined waveforms </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pulldown table </dd></dl>

</div>
</div>
<a id="a70ffec367dd863bd6f03e61ecc4ba2c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70ffec367dd863bd6f03e61ecc4ba2c0">&#9670;&nbsp;</a></span>getInstance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classreSIDfp_1_1WaveformCalculator.html">WaveformCalculator</a> * reSIDfp::WaveformCalculator::getInstance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the singleton instance. </p>

</div>
</div>
<a id="a6cc8f7337506dad1ea099d7e802d9d69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc8f7337506dad1ea099d7e802d9d69">&#9670;&nbsp;</a></span>getWaveTable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmatrix.html">matrix_t</a>* reSIDfp::WaveformCalculator::getWaveTable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the waveform table for use by <a class="el" href="classreSIDfp_1_1WaveformGenerator.html">WaveformGenerator</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>Waveform table </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="WaveformCalculator_8h_source.html">WaveformCalculator.h</a></li>
<li>WaveformCalculator.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 29 2024 17:03:13 for libsidplayfp by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
